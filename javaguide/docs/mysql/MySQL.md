## 基础概念
### 事务
* 数据库事务
    * 数据库最小执行单位。
### 四个特性ACID
* 原子性。要么全部成功，要么全部不做
* 一致性：事务开始和完成前，数据库的数据要保持一致
* 隔离性：事务之间是相互独立的，中间状态对外不可见。
* 持久性：数据的修改是永久的。
* ===================
* 这里要注意的事，所以这些都是针对事务的特性。当把事务看作是最小执行单位后，所有的东西就都可以理解了。
    * 原子性好理解。
    * 一致性是，因为这个事务是最小单位，就跟compareAndSet一样，你就是不能中间被谁插进来
    * 隔离性也好理解了。
    * 可以这么理解，最小执行单位，你可以把它假装成，逻辑串行。
### 隔离级别
* 并发情况下事务会引发的问题
    * 脏读：别人还没commit，我就看到了他的状态。违反隔离性
    * 不可重复读：我在事务中间，多次读一个数据，读到不同的。违反一致性
    * 幻读，我在事务中间多次读取，读到一个我之前没读到的数据。违反一致性
* 解决隔离和并发的问题：
    * read-uncommited
        * 写要拿锁（事务结束释放）
        * 读不用锁。
        * 所以你才可以随便读到别人都还没提交的东西。因为没人限制你。
    * read-commited
        * 写要拿锁（事务结束释放）
        * 读也要拿锁。但是这个锁是语句级别而不是事务级别的。
        * 也就是说，你第一句读完，锁就释放了。这时候中间可能有其他事务，拿到这个锁，人家就去改了，然后人家的事务也结束了。
        你就又可以拿到这个锁，你再去读，诶，跟你上一句读的不一样。
        虽然你还是在同一个事务里。但是你读到了不同的东西。
    * repeatble-read
        * 写要拿锁（事务结束释放）。
        * 读要拿锁，也是事务结束释放，只是是行锁。
        * 所以可能中间人家加了一条，你就懵了。别人是insert一条数据，不是update。你锁不住。
    * serializable
        * 话不多说，锁表。
    
### 数据库sql注入
* 主要就是对引号加反译符。
* 因为用户就是通过加引号结束上条sql
```
#sql注入(用户输入非法的值)使用Statement对象，无法防止sql注入(TRUNCATE操作很危险)
SELECT * FROM admin WHERE username = '韦小宝' AND PASSWORD = ''; TRUNCATE TABLE tableName;#'
#sql注入(用户输入非法的值)使用PreparedStatement对象，可以有效防止sql注入
SELECT * FROM admin WHERE username = '韦小宝' AND PASSWORD = '\'; truncate table tableName;#'
    
```

    
    
    
    
    
    